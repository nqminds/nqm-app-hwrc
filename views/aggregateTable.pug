extends ./layout.pug

block rightNavMenu
  li
    a(href=nidModeToggle.url) #{nidModeToggle.text}

block rightNavMenuMobile
  li
    a(href=nidModeToggle.url) #{nidModeToggle.text}                 

block content
  script.
    $(function() {
      $(".aggregateRow").click(function() {
        alert("clicked row " + this.dataset.field);
      });
    });

    $(document).ready(function () {

      populate_filter_form1();

      $('select').material_select();

      $('#filter_form').on('submit', function (res) {
        generate_url();
        return false;
      });

    });



  div.row
    ul.collapsible(data-collapsible='accordion')
      li
        .collapsible-header
          i.material-icons filter_list
          | filter
        .collapsible-body

          .row
            form.col.s12#filter_form

              .row Dataset:
              .row
                .input-field.col.s4
                  input#dataset_id.validate(value='SkgFcSoEX', type='text')
                  label(for='dataset_id') dataset Id

              .row Filters:
              .row
                .input-field.col.s4
                  select(multiple='')#sid_select
                    option(value='', disabled='', selected='') Choose your year
                  label SID
                .input-field.col.s4
                  select(multiple='')#nid_select
                    option(value='', disabled='', selected='') Choose your network
                  label NID
                .input-field.col.s4
                  select(multiple='')#hwrc_select
                    option(value='', disabled='', selected='') Choose your hwrc
                  label HWRC
              .row
                .input-field.col.s4
                  select(multiple='')#waste_select
                    option(value='', disabled='', selected='') Choose your waste type
                    label Waste Type
                .input-field.col.s4
                  select(multiple='')#move_select
                    option(value='', disabled='', selected='') Choose your first movement
                  label First Movement
                .input-field.col.s4
                  select(multiple='')#contract_select
                    option(value='', disabled='', selected='') Choose your contract type
                  label Contract

              .row Columns:
              .row
                .col.s2
                  input#sid-box.filled-in(type='checkbox')
                  label(for='sid-box').check_space SID
                .col.s2
                  input#nid-box.filled-in(type='checkbox')
                  label(for='nid-box').check_space NID
                .col.s2
                  input#hwrc-box.filled-in(type='checkbox')
                  label(for='hwrc-box').check_space HWRC
                .col.s2
                  input#waste-box.filled-in(type='checkbox')
                  label(for='waste-box').check_space Waste Type
                .col.s2
                  input#move-box.filled-in(type='checkbox')
                  label(for='move-box').check_space First Movement
                .col.s2
                  input#contract-box.filled-in(type='checkbox')
                  label(for='contract-box').check_space Contract
                .row

                .row Calculations:
                .row
                  .col.s2
                    input#tonnage-box.filled-in(type='checkbox')
                    label(for='tonnage-box').check_space Tonnage
                  .col.s2
                    input#delta_tonnage-box.filled-in(type='checkbox')
                    label(for='delta_tonnage-box').check_space Delta Tonnage
                  .col.s2
                    input#cost-box.filled-in(type='checkbox')
                    label(for='cost-box').check_space Cost
                  .col.s2
                    input#delta_cost-box.filled-in(type='checkbox')
                    label(for='delta_cost-box').check_space Delta Cost

                .row
                  button.btn.waves-effect.waves-light(type='submit', name='action')
                    | Submit
                    i.material-icons.right send








  div.row
    div.col.s12
      table.bordered.highlight
        thead
          tr
            //- Add a header for each column.
            each column in columns
              th(data-field=column.key)
                a(href=column.sortURL) #{column.title}
                  i.right.material-icons #{column.sortIcon}
        tbody
          //- Add a row for each data item.
          each row in data
            tr.aggregateRow(data-field=row.__idx)
              //- Within the row, add a cell for each column heading.
              each column in columns
                //- Use Array.reduce to lookup the json path, e.g. evaluate row["_id.SID"]
                td= column.key.split(".").reduce(function(obj, key) { return obj[key] }, row)
        
    

